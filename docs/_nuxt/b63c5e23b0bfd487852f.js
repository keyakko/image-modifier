(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{149:function(e,t,n){"use strict";function r(e){for(var p in e)t.hasOwnProperty(p)||(t[p]=e[p])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(154)),r(n(155)),r(n(164)),r(n(165)),r(n(150)),r(n(166)),r(n(167)),r(n(168)),r(n(169))},150:function(e,t,n){"use strict";function r(e){return new Promise(t=>{const n=new FileReader;n.onload=e=>{const n=e.target.result;t(new Uint8Array(n))},n.readAsArrayBuffer(e)})}function o(e){return new Blob([e])}async function c(e,t=e.name){return{name:t,content:await r(e.blob)}}function l(e,t=e.name){return{name:t,blob:o(e.content)}}function m(e){try{return decodeURIComponent(new URL(e).pathname.split("/").pop())}catch(t){const s=`http://foo.com/${e}`;try{return decodeURIComponent(new URL(s).pathname.split("/").pop())}catch(t){return e}return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.blobToUint8Array=r,t.blobToString=function(e){return new Promise(t=>{const n=new FileReader;n.addEventListener("loadend",e=>{const text=e.srcElement.result;t(text)}),n.readAsText(e)})},t.buildInputFile=async function(e,t=m(e)){const n=await fetch(e),r=await n.arrayBuffer();return{name:t,content:new Uint8Array(r)}},t.uint8ArrayToBlob=o,t.outputFileToInputFile=c,t.inputFileToOutputFile=l,t.asInputFile=async function(e){return e.blob?await c(e):e},t.asOutputFile=async function(e){return e.content?await l(e):e},t.getFileName=m,t.getFileNameExtension=function(e){const s=m(e);return s.substring(s.lastIndexOf(".")+1,s.length)}},154:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(149),o=n(163);async function c(e){try{const t=r.asCommand(e.commands)[0],n=performance.now();l.forEach(e=>e.beforeExecute({command:t,took:performance.now()-n,id:n}));const o={outputFiles:await r.Call(e.inputFiles,t.map(e=>e+""))};return l.forEach(e=>e.afterExecute({command:t,took:performance.now()-n,id:n})),o}catch(e){return{outputFiles:[],errors:[e]}}}t.executeOne=c;const l=[];t.addExecuteListener=function(e){l.push(e)},t.execute=async function(e){const t={},n={};e.inputFiles.forEach(e=>{n[e.name]=e});let l=[];const m=r.asCommand(e.commands);return await o.default(m,(async function(e){const m={inputFiles:Object.keys(n).map(e=>n[e]),commands:[e]},f=await c(m);await o.default(f.outputFiles,async e=>{t[e.name]=e;const o=await r.outputFileToInputFile(e);n[o.name]=o}),l=l.concat(f.errors)}),{concurrency:1}),{outputFiles:Object.keys(t).map(e=>t[e]),errors:l}}},155:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(150);class o{constructor(){this.images={}}get(e){return this.images[e]}async getAll(){return await Promise.all(Object.keys(this.images).map(e=>this.images[e]))}register(e,t=e.name){const n=r.asInputFile(e);return this.images[t]=n,this.images[t].catch(()=>{}).then(()=>{n.resolved=!0}),n}isRegistered(e,t=!0){return this.images[e]&&t&&this.images[e].resolved}}t.createImageHome=function(){return new o}},163:function(e,t,n){"use strict";const r=(e,t,n)=>new Promise((r,o)=>{if(n=Object.assign({concurrency:1/0},n),"function"!=typeof t)throw new TypeError("Mapper function is required");const{concurrency:c}=n;if(!("number"==typeof c&&c>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${c}\` (${typeof c})`);const l=[],m=e[Symbol.iterator]();let f=!1,d=!1,h=0,w=0;const y=()=>{if(f)return;const e=m.next(),i=w;if(w++,e.done)return d=!0,void(0===h&&r(l));h++,Promise.resolve(e.value).then(element=>t(element,i)).then(e=>{l[i]=e,h--,y()},e=>{f=!0,o(e)})};for(let i=0;i<c&&(y(),!d);i++);});e.exports=r,e.exports.default=r},164:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(154),o=n(155);t.newExecutionContext=function(e){return c.create(e)};class c{constructor(e=o.createImageHome()){this.imageHome=e}async execute(e){const t=function(e){if("string"==typeof e)return{inputFiles:[],commands:[e]};return e.inputFiles?e:{commands:e,inputFiles:[]}}(e);t.inputFiles.forEach(e=>{this.imageHome.register(e)});const n=await this.imageHome.getAll(),o=await r.execute(Object.assign({},t,{inputFiles:n}));return o.outputFiles.forEach(e=>{this.imageHome.register(e)}),o}addFiles(e){e.forEach(e=>this.imageHome.register(e))}async getAllFiles(){return this.imageHome.getAll()}static create(e){if(e&&!e.imageHome)throw new Error("Dont know how to inherith from other ExecutionContext implementation than this one");return new c(e&&e.imageHome)}}},165:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Call=function(e,t){const n={files:e,args:t,requestNumber:c},l=function(){let e,t;const n=new Promise((n,r)=>{e=n,t=r});return n.resolve=e,n.reject=t,n}();return o[c]=l,r.postMessage(n),c+=1,l};const r=new Worker("magick.js"),o={};let c=1;r.onmessage=e=>{const t=e.data,n=o[t.requestNumber];delete o[t.requestNumber];const r=t.processed;0===r.length?n.reject("No files generated"):n.resolve(r)}},166:function(e,t,n){"use strict";function r(e){let t=!1;const n=[0];for(let r=0;r<e.length;r++){const o=e[r];o.match(/[\s]/im)&&!t&&n.push(r),"'"===o&&(t=!t)}return n.push(e.length),n.map((t,i)=>e.substring(0===i?0:n[i-1],n[i]).trim()).filter(s=>!!s).map(s=>s.startsWith("'")?s.substring(1,s.length):s).map(s=>s.endsWith("'")?s.substring(0,s.length-1):s).map(s=>"\\("===s?"(":"\\)"===s?")":s)}Object.defineProperty(t,"__esModule",{value:!0}),t.arrayToCli=function(e){return e.map(e=>e+"").map(e=>e.trim().match(/\s/)?`'${e}'`:e).map(e=>"("===e.trim()?"\\(":")"===e.trim()?"\\)":e).join(" ")},t.cliToArray=r,t.asCommand=function e(t){return"string"==typeof t?e([t]):t[0]?"string"==typeof t[0]?t.map(e=>r(e)):t:[]}},167:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(150);t.loadImageElement=async function(image,e){const t=await r.asOutputFile(image);e.src=URL.createObjectURL(t.blob)},t.getInputFilesFromHtmlInputElement=async function(e){return(await async function(e){return Promise.all(function(e){const t=[];for(let i=0;i<e.files.length;i++){const n=e.files.item(i);t.push(n)}return t}(e).map(async e=>{const content=await new Promise(t=>{const n=new FileReader;n.addEventListener("loadend",e=>{t(new Uint8Array(n.result))}),n.readAsArrayBuffer(e)});return{file:e,content:content}}))}(e)).map(e=>({name:e.file.name,content:e.content}))}},168:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(149);async function o(e,t){const n=await r.Call([await r.asInputFile(e),await r.asInputFile(t)],["convert",e.name,t.name,"-resize","256x256^!","-metric","RMSE","-format","%[distortion]","-compare","info:info.txt"]),o=await r.blobToString(n[0].blob);return parseFloat(o)}t.compare=async function(e,t,n=.01){return await o(e,t)<=n},t.compareNumber=o,t.extractInfo=async function(img){const e=await r.asInputFile(img),t=await r.Call([e],["convert",e.name,"info.json"]);return JSON.parse(await r.blobToString(t[0].blob))}},169:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.knownSupportedReadWriteImageFormats=["jpg","png","psd","tiff","xcf","gif","bmp","tga","miff","ico","dcm","xpm","pcx","fits","ppm","pgm","pfm","mng","hdr","dds","otb","txt"]},172:function(e,t,n){"use strict";n.r(t);n(156),n(31),n(55);var r=n(149),o={components:{VueCompareImage:function(){return n.e(5).then(n.t.bind(null,171,7))}},data:function(){return{convert_options:'[ "convert", "srcFile.jpg", "-charcoal", "2", "out.png" ]',image_original:{name:"",image:null,thumbnail:""},image_modified:""}},watch:{image_original:{handler:function(e,t){""!=e.name&&null!=e.image&&this.doMagick()},deep:!0}},methods:{onImageChanged:function(e){var t=this,n=e.target.files||e.dataTransfer.files;if(n&&n[0]){var r=new FileReader;r.addEventListener("load",(function(){t.image_original.name=n[0].name,t.image_original.name&&t.image_original.name.lastIndexOf(".")<=0||(t.image_original.thumbnail=r.result,t.image_original.image=n[0])})),r.readAsDataURL(n[0])}},doMagick:function(){var e,t,n,o,c;return regeneratorRuntime.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.t0=Uint8Array,l.next=3,regeneratorRuntime.awrap(this.image_original.image.arrayBuffer());case 3:return l.t1=l.sent,e=new l.t0(l.t1),t=[{name:this.image_original.name,content:e}],[],n=JSON.parse('[ "convert", "'+this.image_original.name+'", "-type", "GrayScale", "out.png" ]'),l.next=10,regeneratorRuntime.awrap(r.Call(t,n));case 10:o=l.sent,c=o[0],console.log(c),this.image_modified=URL.createObjectURL(c.blob),console.log("created image "+c.name);case 15:case"end":return l.stop()}}),null,this)}}},c=n(21),l={components:{Magick:Object(c.a)(o,(function(){var e=this.$createElement,t=this._self._c||e;return t("no-ssr",[t("div",{staticClass:"container"},[t("div",{staticClass:"my-12"},[t("input",{attrs:{type:"file",name:"",id:""},on:{change:this.onImageChanged}})]),this._v(" "),""!==this.image_modified?t("vue-compare-image",{attrs:{leftImage:this.image_original.thumbnail,rightImage:this.image_modified}}):this._e()],1)])}),[],!1,null,null,null).exports}},m=Object(c.a)(l,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("magick")],1)}),[],!1,null,null,null);t.default=m.exports}}]);